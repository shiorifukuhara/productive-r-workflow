---
title: "Penguin Analysis"
subtitle: "Exoloring the penguin datasets through data visualisation with R"
author:
  - name: Shiori Fukuhara
    email: shiori.fukuhara.20@ucl.ac.uk
    affiliation: 
      - name: University College London
keywords: "Data Analysis, Data Analysis, Data Visualisation"
date: today
title-block-banner: "#C1EBF9"
title-block-banner-color: "black"
format: 
  html:
    toc: true
    toc-location: left
    number-sections: true
    code-fold: true
    code-summary: "Show the code"
css: style.css
editor: source
fig-cap-location: margin
---

## Introduction

To analyse the relationship between the **bill length and bill depth** of the penguins that live in **three different islands**, I made a scatterplot that plots two of the variables with color verification of three types of species.

Data I used for this analysis is retreived from [palmerpenguins](https://allisonhorst.github.io/palmerpenguins/)

::: {.callout-note collapse="true"}
This is an exploratory analysis of the penguin datasets only for personal learning purposes. It doesn not give a comprehensive analysis based on scientificcally-sound practices. 
:::

Start off with loading `tidyverse` and get started!

```{r, warning=FALSE, message=FALSE}
library(tidyverse)
```

## Data loading

Data is cleaned by identifying and excluding the observations that have no values.

```{r, warning=FALSE, message=FALSE}
# Source functions
source(file="functions.R")

# Read the clean dataset
data <- readRDS(file = "C:/Users/shior/OneDrive/Desktop/productive-r-workflow/input/clean_data.rds")
```

### By the way, what are the bill length and depth?

![Simply find this illustration](asset/culmen_depth.png){width="300"}


## Three species comparison

Let's delve into the penguin data to find something interesting that can tell important findings about the three penguin species.

This is the whole data to start with.

```{r, warning=FALSE, message=FALSE}
library(DT)
datatable(data, options = list(pageLength = 5), filter = "top")
```




Three species might have some different characteristics in their average bill length and depth.

```{r, fig.align = "center", fig.width=3, fig.height=3, warning=FALSE, message=FALSE}
#| layout-ncol: 2
#Compute the average bill length and bill depth per species

# Load the knitr library
library(knitr)

# Compute some result
bill_length_per_specie <- data %>% group_by(species) %>% 
  summarise(average_bill_length = mean(bill_length_mm, na.rm = TRUE))

bill_depth_per_specie <- data %>% group_by(species) %>% 
  summarise(average_bill_depth = mean(bill_depth_mm, na.rm = TRUE))

# Display in the Quarto report
kable(bill_length_per_specie)
kable(bill_depth_per_specie)
```


## First descriptive analytics

I plotted this data to a `scatterplot` of R to demonstrate the *correlation between the length and depth of penguin bills*.

```{r, fig.align = "center", fig.width=5, fig.height=5, warning=FALSE, message=FALSE}
library(dplyr)
library(ggplot2)

species_colors <- c(
  "Adelie"    = "#1b9e77",
  "Chinstrap" = "#d95f02",
  "Gentoo"    = "#7570b3"
)

create_scatterplot <- function(data, selected_species, selected_island, show_legend = TRUE) {
  # Filter the data for the specified species and island
  filtered_data <- data %>%
    na.omit() %>%
    filter(species == selected_species, island == selected_island)

  # Create the scatterplot
  plot <- ggplot(
    filtered_data,
    aes(x = bill_length_mm, y = bill_depth_mm, color = species)
  ) +
    geom_point() +
    scale_color_manual(values = species_colors) +
    labs(
      x = "Bill Length (mm)",
      y = "Bill Depth (mm)",
      title = paste("Penguin Bill Dimensions â€” All Islands", color = "Species")
    ) +
    theme_minimal(base_size = 12) +
    theme(legend.position = if (show_legend) "right" else "none")
  return(plot)
}

# Use the function and build an interactive chart
library(plotly)
ggplotly(create_scatterplot(data, c("Adelie","Chinstrap", "Gentoo"), c("Torgersen","Dream", "Biscoe")))
```


## Second descriptive analysis

Then, the data is individually plotted for 3 species.

```{r, warning=FALSE, message=FALSE}
library(patchwork)
library(ggplot2)

p1 <- create_scatterplot(data, "Adelie", c("Torgersen","Dream", "Biscoe"), show_legend = FALSE) + labs(title = NULL)
p2 <- create_scatterplot(data, "Chinstrap", c("Torgersen","Dream", "Biscoe"), show_legend = FALSE) + labs(title = NULL)
p3 <- create_scatterplot(data, "Gentoo", c("Torgersen","Dream", "Biscoe"), show_legend = FALSE) + labs(title = NULL)

p1 + p2 + p3 + plot_annotation(title = "Penguin Bill Dimensions by Species")

```
